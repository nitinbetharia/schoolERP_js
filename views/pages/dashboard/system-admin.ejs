<!-- System Admin Dashboard -->
<% currentPath = '/system/dashboard'; %>

<div class="row">
   <div class="col-12">
      <div class="d-flex justify-content-between align-items-center mb-4">
         <div>
            <h1 class="h3 mb-1">System Dashboard</h1>
            <p class="text-muted mb-0">Overview of all trusts and system health</p>
         </div>
         <div>
            <button type="button" class="btn btn-brand-primary" data-bs-toggle="modal" data-bs-target="#addTrustModal">
               <i class="fas fa-plus me-1"></i>Add Trust
            </button>
         </div>
      </div>
   </div>
</div>

<!-- Stats Cards -->
<div class="row g-3 mb-4">
   <div class="col-md-3">
      <div class="card bg-primary text-white">
         <div class="card-body">
            <div class="d-flex justify-content-between">
               <div>
                  <h6 class="card-title mb-1">Total Trusts</h6>
                  <h2 class="mb-0"><%= stats ? stats.totalTrusts : '-' %></h2>
               </div>
               <div class="align-self-center">
                  <i class="fas fa-building fa-2x opacity-75"></i>
               </div>
            </div>
         </div>
      </div>
   </div>
   <div class="col-md-3">
      <div class="card bg-success text-white">
         <div class="card-body">
            <div class="d-flex justify-content-between">
               <div>
                  <h6 class="card-title mb-1">Active Trusts</h6>
                  <h2 class="mb-0"><%= stats ? stats.activeTrusts : '-' %></h2>
               </div>
               <div class="align-self-center">
                  <i class="fas fa-school fa-2x opacity-75"></i>
               </div>
            </div>
         </div>
      </div>
   </div>
   <div class="col-md-3">
      <div class="card bg-info text-white">
         <div class="card-body">
            <div class="d-flex justify-content-between">
               <div>
                  <h6 class="card-title mb-1">System Users</h6>
                  <h2 class="mb-0"><%= stats ? stats.totalSystemUsers : '-' %></h2>
               </div>
               <div class="align-self-center">
                  <i class="fas fa-user-cog fa-2x opacity-75"></i>
               </div>
            </div>
         </div>
      </div>
   </div>
   <div class="col-md-3">
      <div class="card <%= stats && stats.systemHealth === 'healthy' ? 'bg-warning' : 'bg-danger' %> text-white">
         <div class="card-body">
            <div class="d-flex justify-content-between">
               <div>
                  <h6 class="card-title mb-1">System Health</h6>
                  <h2 class="mb-0">
                     <% if (stats && stats.systemHealth === 'healthy') { %>
                        <i class="fas fa-check"></i>
                     <% } else if (stats && stats.systemHealth === 'unhealthy') { %>
                        <i class="fas fa-exclamation-triangle"></i>
                     <% } else { %>
                        <i class="fas fa-question"></i>
                     <% } %>
                  </h2>
               </div>
               <div class="align-self-center">
                  <i class="fas fa-heartbeat fa-2x opacity-75"></i>
               </div>
            </div>
         </div>
      </div>
   </div>
</div>

<!-- Main Content -->
<div class="row">
   <!-- Recent Activity -->
   <div class="col-lg-8">
      <div class="card">
         <div class="card-header">
            <h5 class="card-title mb-0">Recent Activity</h5>
         </div>
         <div class="card-body">
            <div class="table-responsive">
               <table class="table table-sm">
                  <thead>
                     <tr>
                        <th>Time</th>
                        <th>Trust</th>
                        <th>Action</th>
                        <th>Status</th>
                     </tr>
                  </thead>
                  <tbody>
                     <tr>
                        <td><small class="text-muted">2 min ago</small></td>
                        <td>ABC Education Trust</td>
                        <td>New school registered</td>
                        <td><span class="badge bg-success">Success</span></td>
                     </tr>
                     <tr>
                        <td><small class="text-muted">5 min ago</small></td>
                        <td>XYZ Schools</td>
                        <td>Bulk student enrollment</td>
                        <td><span class="badge bg-info">Processing</span></td>
                     </tr>
                     <tr>
                        <td><small class="text-muted">10 min ago</small></td>
                        <td>Global Academy</td>
                        <td>System backup completed</td>
                        <td><span class="badge bg-success">Success</span></td>
                     </tr>
                  </tbody>
               </table>
            </div>
         </div>
      </div>
   </div>

   <!-- System Status -->
   <div class="col-lg-4">
      <div class="card">
         <div class="card-header">
            <h5 class="card-title mb-0">System Status</h5>
         </div>
         <div class="card-body">
            <div class="d-flex justify-content-between align-items-center mb-3">
               <span>Database</span>
               <span class="badge <%= stats && stats.databaseStatus === 'connected' ? 'bg-success' : 'bg-danger' %>">
                  <%= stats && stats.databaseStatus === 'connected' ? 'Online' : 'Offline' %>
               </span>
            </div>
            <div class="d-flex justify-content-between align-items-center mb-3">
               <span>System Health</span>
               <span class="badge <%= stats && stats.systemHealth === 'healthy' ? 'bg-success' : stats && stats.systemHealth === 'unhealthy' ? 'bg-danger' : 'bg-warning' %>">
                  <% if (stats && stats.systemHealth === 'healthy') { %>
                     Healthy
                  <% } else if (stats && stats.systemHealth === 'unhealthy') { %>
                     Issues
                  <% } else { %>
                     Unknown
                  <% } %>
               </span>
            </div>
            <div class="d-flex justify-content-between align-items-center mb-3">
               <span>Active Users</span>
               <span class="badge bg-info"><%= stats ? stats.activeUsers : 0 %> online</span>
            </div>
            <div class="d-flex justify-content-between align-items-center mb-3">
               <span>Pending Trusts</span>
               <span class="badge <%= stats && stats.pendingTrusts > 0 ? 'bg-warning' : 'bg-success' %>">
                  <%= stats ? stats.pendingTrusts : 0 %> pending
               </span>
            </div>
            <hr />
            <div class="text-center">
               <a href="/system/health" class="btn btn-outline-primary btn-sm">
                  <i class="fas fa-chart-line me-1"></i>View Details
               </a>
            </div>
            <% if (stats && stats.error) { %>
            <div class="mt-3">
               <div class="alert alert-warning alert-sm mb-0">
                  <small><i class="fas fa-exclamation-triangle me-1"></i><%= stats.error %></small>
               </div>
            </div>
            <% } %>
         </div>
      </div>
   </div>
</div>
