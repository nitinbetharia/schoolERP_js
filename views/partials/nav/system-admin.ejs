<!-- System Admin Sidebar Navigation -->
<nav id="sidebar" class="col-md-3 col-lg-2 d-md-block bg-white shadow-sm sidebar collapse">
   <div class="position-sticky pt-3">
      <!-- Main Navigation -->
      <div class="sidebar-content">
         <!-- Dashboard -->
         <div class="nav-section">
            <ul class="nav flex-column">
               <li class="nav-item">
                  <a
                     class="nav-link <%= (currentPath === '/admin/system' || currentPath === '/system') ? 'active' : '' %>"
                     href="/system">
                     <i class="bi bi-speedometer2 nav-icon"></i>
                     <span>Dashboard</span>
                  </a>
               </li>
            </ul>
         </div>

         <!-- Core System Management -->
         <div class="nav-section">
            <h6 class="sidebar-heading">Core System</h6>
            <ul class="nav flex-column">
               <li class="nav-item">
                  <a
                     class="nav-link <%= currentPath && currentPath.includes('/system/trusts') ? 'active' : '' %>"
                     data-bs-toggle="collapse"
                     href="#trustsMenu"
                     role="button"
                     aria-expanded="false">
                     <i class="bi bi-buildings nav-icon"></i>
                     <span>Trust Management</span>
                     <i class="bi bi-chevron-down dropdown-arrow"></i>
                  </a>
                  <div
                     class="collapse <%= currentPath && currentPath.includes('/system/trusts') ? 'show' : '' %>"
                     id="trustsMenu">
                     <ul class="nav flex-column sub-menu">
                        <li class="nav-item">
                           <a class="nav-link" href="/system/trusts"> <i class="bi bi-list-ul"></i>All Trusts </a>
                        </li>
                        <li class="nav-item">
                           <a class="nav-link" href="/system/trusts/new">
                              <i class="bi bi-plus-circle"></i>Add Trust
                           </a>
                        </li>
                        <li class="nav-item">
                           <a class="nav-link" href="/system/trusts/analytics">
                              <i class="bi bi-graph-up"></i>Analytics
                           </a>
                        </li>
                        <li class="nav-item">
                           <a class="nav-link" href="/system/trusts/setup"> <i class="bi bi-gear"></i>Trust Setup </a>
                        </li>
                     </ul>
                  </div>
               </li>
               <li class="nav-item">
                  <a
                     class="nav-link <%= currentPath && currentPath.includes('/system/schools') ? 'active' : '' %>"
                     data-bs-toggle="collapse"
                     href="#schoolsMenu"
                     role="button"
                     aria-expanded="false">
                     <i class="bi bi-bank nav-icon"></i>
                     <span>School Management</span>
                     <i class="bi bi-chevron-down dropdown-arrow"></i>
                  </a>
                  <div
                     class="collapse <%= currentPath && currentPath.includes('/system/schools') ? 'show' : '' %>"
                     id="schoolsMenu">
                     <ul class="nav flex-column sub-menu">
                        <li class="nav-item">
                           <a class="nav-link" href="/system/schools"> <i class="bi bi-list-ul"></i>All Schools </a>
                        </li>
                        <li class="nav-item">
                           <a class="nav-link" href="/system/schools/performance">
                              <i class="bi bi-bar-chart"></i>Performance
                           </a>
                        </li>
                        <li class="nav-item">
                           <a class="nav-link" href="/system/schools/compliance">
                              <i class="bi bi-check-circle"></i>Compliance
                           </a>
                        </li>
                     </ul>
                  </div>
               </li>
            </ul>
         </div>

         <!-- User & Access Management -->
         <div class="nav-section">
            <h6 class="sidebar-heading">User Management</h6>
            <ul class="nav flex-column">
               <li class="nav-item">
                  <a
                     class="nav-link <%= currentPath && currentPath.includes('/system/users') ? 'active' : '' %>"
                     data-bs-toggle="collapse"
                     href="#usersMenu"
                     role="button"
                     aria-expanded="false">
                     <i class="bi bi-people nav-icon"></i>
                     <span>System Users</span>
                     <i class="bi bi-chevron-down dropdown-arrow"></i>
                  </a>
                  <div
                     class="collapse <%= currentPath && currentPath.includes('/system/users') ? 'show' : '' %>"
                     id="usersMenu">
                     <ul class="nav flex-column sub-menu">
                        <li class="nav-item">
                           <a class="nav-link" href="/system/users"> <i class="bi bi-list-ul"></i>All Users </a>
                        </li>
                        <li class="nav-item">
                           <a class="nav-link" href="/system/users/new"> <i class="bi bi-person-plus"></i>Add User </a>
                        </li>
                        <li class="nav-item">
                           <a class="nav-link" href="/system/users/roles">
                              <i class="bi bi-shield-check"></i>Role Management
                           </a>
                        </li>
                        <li class="nav-item">
                           <a class="nav-link" href="/system/users/permissions">
                              <i class="bi bi-key"></i>Permissions
                           </a>
                        </li>
                     </ul>
                  </div>
               </li>
               <li class="nav-item">
                  <a class="nav-link" href="/system/sessions">
                     <i class="bi bi-activity nav-icon"></i>
                     <span>Active Sessions</span>
                  </a>
               </li>
               <li class="nav-item">
                  <a class="nav-link" href="/system/audit">
                     <i class="bi bi-journal-text nav-icon"></i>
                     <span>Audit Logs</span>
                  </a>
               </li>
            </ul>
         </div>

         <!-- System Operations -->
         <div class="nav-section">
            <h6 class="sidebar-heading">Operations</h6>
            <ul class="nav flex-column">
               <li class="nav-item">
                  <a
                     class="nav-link <%= currentPath && currentPath.includes('/system/health') ? 'active' : '' %>"
                     data-bs-toggle="collapse"
                     href="#monitoringMenu"
                     role="button"
                     aria-expanded="false">
                     <i class="bi bi-heart-pulse nav-icon"></i>
                     <span>Monitoring</span>
                     <i class="bi bi-chevron-down dropdown-arrow"></i>
                  </a>
                  <div
                     class="collapse <%= currentPath && currentPath.includes('/system/health') || currentPath && currentPath.includes('/system/monitoring') ? 'show' : '' %>"
                     id="monitoringMenu">
                     <ul class="nav flex-column sub-menu">
                        <li class="nav-item">
                           <a class="nav-link" href="/system/health">
                              <i class="bi bi-heart-pulse"></i>System Health
                           </a>
                        </li>
                        <li class="nav-item">
                           <a class="nav-link" href="/system/performance">
                              <i class="bi bi-speedometer"></i>Performance
                           </a>
                        </li>
                        <li class="nav-item">
                           <a class="nav-link" href="/system/analytics"> <i class="bi bi-graph-up"></i>Analytics </a>
                        </li>
                        <li class="nav-item">
                           <a class="nav-link" href="/system/logs"> <i class="bi bi-file-text"></i>System Logs </a>
                        </li>
                     </ul>
                  </div>
               </li>
               <li class="nav-item">
                  <a class="nav-link" data-bs-toggle="collapse" href="#dataMenu" role="button" aria-expanded="false">
                     <i class="bi bi-database nav-icon"></i>
                     <span>Data Management</span>
                     <i class="bi bi-chevron-down dropdown-arrow"></i>
                  </a>
                  <div class="collapse" id="dataMenu">
                     <ul class="nav flex-column sub-menu">
                        <li class="nav-item">
                           <a class="nav-link" href="/system/backups">
                              <i class="bi bi-cloud-arrow-down"></i>Backups
                           </a>
                        </li>
                        <li class="nav-item">
                           <a class="nav-link" href="/system/migrations">
                              <i class="bi bi-arrow-repeat"></i>Migrations
                           </a>
                        </li>
                        <li class="nav-item">
                           <a class="nav-link" href="/system/imports"> <i class="bi bi-upload"></i>Data Import </a>
                        </li>
                        <li class="nav-item">
                           <a class="nav-link" href="/system/exports"> <i class="bi bi-download"></i>Data Export </a>
                        </li>
                     </ul>
                  </div>
               </li>
            </ul>
         </div>

         <!-- Configuration & Settings -->
         <div class="nav-section">
            <h6 class="sidebar-heading">Configuration</h6>
            <ul class="nav flex-column">
               <li class="nav-item">
                  <a class="nav-link" data-bs-toggle="collapse" href="#configMenu" role="button" aria-expanded="false">
                     <i class="bi bi-gear nav-icon"></i>
                     <span>System Settings</span>
                     <i class="bi bi-chevron-down dropdown-arrow"></i>
                  </a>
                  <div class="collapse" id="configMenu">
                     <ul class="nav flex-column sub-menu">
                        <li class="nav-item">
                           <a class="nav-link" href="/system/config/general"> <i class="bi bi-sliders"></i>General </a>
                        </li>
                        <li class="nav-item">
                           <a class="nav-link" href="/system/config/security">
                              <i class="bi bi-shield-lock"></i>Security
                           </a>
                        </li>
                        <li class="nav-item">
                           <a class="nav-link" href="/system/config/email">
                              <i class="bi bi-envelope-at"></i>Email Settings
                           </a>
                        </li>
                        <li class="nav-item">
                           <a class="nav-link" href="/system/config/integrations">
                              <i class="bi bi-diagram-3"></i>Integrations
                           </a>
                        </li>
                     </ul>
                  </div>
               </li>
               <li class="nav-item">
                  <a class="nav-link" href="/system/maintenance">
                     <i class="bi bi-tools nav-icon"></i>
                     <span>Maintenance</span>
                  </a>
               </li>
            </ul>
         </div>

         <!-- Reports & Analytics -->
         <div class="nav-section">
            <h6 class="sidebar-heading">Reporting</h6>
            <ul class="nav flex-column">
               <li class="nav-item">
                  <a class="nav-link" data-bs-toggle="collapse" href="#reportsMenu" role="button" aria-expanded="false">
                     <i class="bi bi-file-earmark-bar-graph nav-icon"></i>
                     <span>Reports</span>
                     <i class="bi bi-chevron-down dropdown-arrow"></i>
                  </a>
                  <div class="collapse" id="reportsMenu">
                     <ul class="nav flex-column sub-menu">
                        <li class="nav-item">
                           <a class="nav-link" href="/system/reports/system">
                              <i class="bi bi-graph-up"></i>System Reports
                           </a>
                        </li>
                        <li class="nav-item">
                           <a class="nav-link" href="/system/reports/usage">
                              <i class="bi bi-bar-chart"></i>Usage Statistics
                           </a>
                        </li>
                        <li class="nav-item">
                           <a class="nav-link" href="/system/reports/financial">
                              <i class="bi bi-currency-dollar"></i>Financial Reports
                           </a>
                        </li>
                        <li class="nav-item">
                           <a class="nav-link" href="/system/reports/custom">
                              <i class="bi bi-gear"></i>Custom Reports
                           </a>
                        </li>
                     </ul>
                  </div>
               </li>
            </ul>
         </div>

         <!-- Support & Help -->
         <div class="nav-section border-top pt-3">
            <ul class="nav flex-column">
               <li class="nav-item">
                  <a class="nav-link" href="/system/support">
                     <i class="bi bi-life-preserver nav-icon"></i>
                     <span>Support Center</span>
                  </a>
               </li>
               <li class="nav-item">
                  <a class="nav-link" href="/system/documentation">
                     <i class="bi bi-book nav-icon"></i>
                     <span>Documentation</span>
                  </a>
               </li>
            </ul>
         </div>
      </div>
   </div>
</nav>

<style>
   /* System Admin Sidebar Styles */
   .sidebar {
      height: 100vh;
      overflow-y: auto;
      border-right: 1px solid #e9ecef;
   }

   .sidebar-content {
      padding-bottom: 2rem;
   }

   .nav-section {
      margin-bottom: 1.5rem;
   }

   .sidebar-heading {
      font-size: 0.75rem;
      font-weight: 600;
      color: #6c757d;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 0.5rem;
      margin-left: 1rem;
      margin-right: 1rem;
   }

   .nav-link {
      color: #495057;
      padding: 0.75rem 1rem;
      border-radius: 0.375rem;
      margin: 0.125rem 0.5rem;
      transition: all 0.15s ease-in-out;
      display: flex;
      align-items: center;
      text-decoration: none;
      position: relative;
   }

   .nav-link:hover {
      color: #0d6efd;
      background-color: #f8f9fa;
      text-decoration: none;
   }

   .nav-link.active {
      color: #0d6efd;
      background-color: #e7f1ff;
      font-weight: 500;
   }

   .nav-link.active::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 3px;
      background-color: #0d6efd;
      border-radius: 0 2px 2px 0;
   }

   .nav-icon {
      width: 18px;
      height: 18px;
      margin-right: 0.75rem;
      flex-shrink: 0;
   }

   .dropdown-arrow {
      margin-left: auto;
      font-size: 0.75rem;
      transition: transform 0.15s ease-in-out;
   }

   .nav-link[aria-expanded='true'] .dropdown-arrow,
   .collapse.show ~ .nav-link .dropdown-arrow {
      transform: rotate(180deg);
   }

   .sub-menu {
      padding: 0.25rem 0;
      margin-left: 1rem;
   }

   .sub-menu .nav-link {
      padding: 0.5rem 1rem;
      font-size: 0.875rem;
      color: #6c757d;
      margin: 0.0625rem 0.5rem;
   }

   .sub-menu .nav-link:hover {
      color: #495057;
      background-color: #f1f3f4;
   }

   .sub-menu .nav-link.active {
      color: #0d6efd;
      background-color: #e7f1ff;
   }

   .sub-menu .nav-link i {
      width: 14px;
      height: 14px;
      margin-right: 0.5rem;
   }

   /* Responsive Design */
   @media (max-width: 767.98px) {
      .sidebar {
         height: auto;
         border-right: none;
         border-bottom: 1px solid #e9ecef;
      }
   }

   /* Brand Color Variables */
   .bg-brand-primary {
      background-color: #0d6efd !important;
   }

   .text-brand-primary {
      color: #0d6efd !important;
   }

   .btn-brand-primary {
      background-color: #0d6efd;
      border-color: #0d6efd;
      color: white;
   }

   .btn-brand-primary:hover {
      background-color: #0b5ed7;
      border-color: #0a58ca;
   }
</style>
