<!-- Dashboard uses layouts/main layout automatically -->

<!-- Dashboard Page -->
<div class="dashboard-container p-6">
  <!-- Page Header -->
  <div class="mb-8">
    <div class="flex items-center justify-between">
      <div>
        <h1 class="text-3xl font-bold text-blue-600">
          <% if (userRole === 'SYSTEM_ADMIN' || userRole === 'SUPER_ADMIN' || userRole ===
          'SYS_ADMIN') { %> System Dashboard <% } else { %> Dashboard <% } %>
        </h1>
        <p class="text-gray-600 mt-2">
          <% if (userRole === 'SYSTEM_ADMIN' || userRole === 'SUPER_ADMIN' || userRole ===
          'SYS_ADMIN') { %> Welcome back, <%= userData?.name || 'Admin' %>! Manage the entire system
          from here. <% } else { %> Welcome back, <%= userData?.name || 'User' %>! Here's what's
          happening at your institution. <% } %>
        </p>
      </div>
      <div class="flex items-center gap-3">
        <div class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium">
          <% if (userRole === 'SYSTEM_ADMIN' || userRole === 'SYS_ADMIN') { %>
          <i class="<%= icons.SYSTEM_ADMIN %> mr-1"></i>System Admin <% } else if (userRole ===
          'SUPER_ADMIN') { %> <i class="<%= icons.SUPER_ADMIN %> mr-1"></i>Super Admin <% } else if
          (userRole === 'GROUP_ADMIN') { %> <i class="<%= icons.GROUP_ADMIN %> mr-1"></i>Group Admin
          <% } else if (userRole === 'TRUST_ADMIN') { %>
          <i class="<%= icons.TRUST_ADMIN %> mr-1"></i>Trust Admin <% } else { %> <%=
          userRole.replace('_', ' ') %> <% } %>
        </div>
        <button
          class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg text-sm hover:bg-gray-200 transition-colors"
          onclick="location.reload()"
        >
          <i class="<%= icons.REFRESH %> mr-2"></i>
          Refresh
        </button>
        <a
          href="/auth/logout"
          class="px-4 py-2 bg-red-100 text-red-700 rounded-lg text-sm hover:bg-red-200 transition-colors"
        >
          <i class="<%= icons.LOGOUT %> mr-2"></i>
          Logout
        </a>
      </div>
    </div>
  </div>

  <!-- Statistics Grid -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
    <% if (quickStats && Object.keys(quickStats).length > 0) { %> <%
    Object.entries(quickStats).forEach(([key, value]) => { %>
    <div class="bg-white rounded-lg shadow-sm border p-6 hover:shadow-md transition-shadow">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-gray-500 text-sm font-medium">
            <%= key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase()) %>
          </p>
          <p class="text-2xl font-bold text-blue-600 mt-1">
            <%= typeof value === 'number' ? value.toLocaleString() : value %>
          </p>
        </div>
        <div class="p-3 bg-blue-50 rounded-lg">
          <i class="fas fa-chart-bar text-blue-500 text-xl"></i>
        </div>
      </div>
    </div>
    <% }); %> <% } else { %>
    <!-- Default stats for when no data is available -->
    <div class="bg-white rounded-lg shadow-sm border p-6">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-gray-500 text-sm font-medium">Total Students</p>
          <p class="text-2xl font-bold text-blue-600 mt-1">Loading...</p>
        </div>
        <div class="p-3 bg-blue-50 rounded-lg">
          <i class="fas fa-users text-blue-500 text-xl"></i>
        </div>
      </div>
    </div>
    <% } %>
  </div>

  <!-- Main Dashboard Content -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
    <!-- Left Column - Widgets -->
    <div class="lg:col-span-2 space-y-6">
      <!-- Quick Actions -->
      <div class="bg-white rounded-lg shadow-sm border">
        <div class="px-6 py-4 border-b border-gray-200">
          <h3 class="font-semibold flex items-center gap-2 text-gray-800">
            <i class="fas fa-bolt text-blue-500"></i>
            Quick Actions
          </h3>
        </div>
        <div class="p-6">
          <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <% if (userRole === 'SUPER_ADMIN' || userRole === 'SYSTEM_ADMIN' || userRole ===
            'SYS_ADMIN') { %>
            <a
              href="/users"
              class="flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"
            >
              <i class="<%= icons.USERS %> text-2xl text-blue-500 mb-2"></i>
              <span class="text-sm font-medium text-gray-700">Manage Users</span>
            </a>
            <a
              href="/admin/schools"
              class="flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"
            >
              <i class="<%= icons.SCHOOLS %> text-2xl text-green-500 mb-2"></i>
              <span class="text-sm font-medium text-gray-700">Schools</span>
            </a>
            <a
              href="/admin/system-health"
              class="flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"
            >
              <i class="<%= icons.SYSTEM_HEALTH %> text-2xl text-red-500 mb-2"></i>
              <span class="text-sm font-medium text-gray-700">System Health</span>
            </a>
            <a
              href="/admin/settings"
              class="flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"
            >
              <i class="<%= icons.SETTINGS %> text-2xl text-gray-500 mb-2"></i>
              <span class="text-sm font-medium text-gray-700">Settings</span>
            </a>
            <a
              href="/admin/reports"
              class="flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"
            >
              <i class="<%= icons.REPORTS %> text-2xl text-purple-500 mb-2"></i>
              <span class="text-sm font-medium text-gray-700">Reports</span>
            </a>
            <a
              href="/admin/communication"
              class="flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"
            >
              <i class="<%= icons.COMMUNICATION %> text-2xl text-indigo-500 mb-2"></i>
              <span class="text-sm font-medium text-gray-700">Communication</span>
            </a>
            <a
              href="/admin/backup"
              class="flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"
            >
              <i class="<%= icons.BACKUP %> text-2xl text-orange-500 mb-2"></i>
              <span class="text-sm font-medium text-gray-700">Backup</span>
            </a>
            <a
              href="/admin/audit-logs"
              class="flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"
            >
              <i class="<%= icons.AUDIT %> text-2xl text-teal-500 mb-2"></i>
              <span class="text-sm font-medium text-gray-700">Audit Logs</span>
            </a>
            <% } else if (userRole === 'SCHOOL_ADMIN') { %>
            <a
              href="/students"
              class="flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"
            >
              <i class="<%= icons.STUDENT %> text-2xl text-blue-500 mb-2"></i>
              <span class="text-sm font-medium text-gray-700">Students</span>
            </a>
            <a
              href="/attendance"
              class="flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"
            >
              <i class="<%= icons.ATTENDANCE %> text-2xl text-green-500 mb-2"></i>
              <span class="text-sm font-medium text-gray-700">Attendance</span>
            </a>
            <a
              href="/fees"
              class="flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"
            >
              <i class="<%= icons.FEES %> text-2xl text-yellow-500 mb-2"></i>
              <span class="text-sm font-medium text-gray-700">Fee Management</span>
            </a>
            <a
              href="/reports"
              class="flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"
            >
              <i class="fas fa-chart-bar text-2xl text-purple-500 mb-2"></i>
              <span class="text-sm font-medium text-gray-700">Reports</span>
            </a>
            <% } else { %>
            <a
              href="/my-classes"
              class="flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"
            >
              <i class="<%= icons.TEACHER %> text-2xl text-blue-500 mb-2"></i>
              <span class="text-sm font-medium text-gray-700">My Classes</span>
            </a>
            <a
              href="/attendance"
              class="flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"
            >
              <i class="fas fa-calendar-check text-2xl text-green-500 mb-2"></i>
              <span class="text-sm font-medium text-gray-700">Take Attendance</span>
            </a>
            <a
              href="/grades"
              class="flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"
            >
              <i class="<%= icons.GRADES %> text-2xl text-yellow-500 mb-2"></i>
              <span class="text-sm font-medium text-gray-700">Grades</span>
            </a>
            <a
              href="/schedule"
              class="flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"
            >
              <i class="fas fa-calendar text-2xl text-purple-500 mb-2"></i>
              <span class="text-sm font-medium text-gray-700">Schedule</span>
            </a>
            <% } %>
          </div>
        </div>
      </div>

      <!-- Recent Activities -->
      <div class="bg-white rounded-lg shadow-sm border">
        <div class="px-6 py-4 border-b border-gray-200">
          <h3 class="font-semibold flex items-center gap-2 text-gray-800">
            <i class="fas fa-clock text-blue-500"></i>
            Recent Activities
          </h3>
        </div>
        <div class="p-6">
          <div class="space-y-4">
            <div class="flex items-center gap-4 p-3 bg-gray-50 rounded-lg">
              <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                <i class="fas fa-user-plus text-blue-500 text-sm"></i>
              </div>
              <div class="flex-1">
                <p class="text-sm font-medium text-gray-800">New student admission</p>
                <p class="text-xs text-gray-500">John Doe admitted to Class 10-A</p>
              </div>
              <span class="text-xs text-gray-400">2 hours ago</span>
            </div>
            <div class="flex items-center gap-4 p-3 bg-gray-50 rounded-lg">
              <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
                <i class="fas fa-check text-green-500 text-sm"></i>
              </div>
              <div class="flex-1">
                <p class="text-sm font-medium text-gray-800">Attendance marked</p>
                <p class="text-xs text-gray-500">Class 9-B attendance completed</p>
              </div>
              <span class="text-xs text-gray-400">4 hours ago</span>
            </div>
            <div class="flex items-center gap-4 p-3 bg-gray-50 rounded-lg">
              <div class="w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center">
                <i class="fas fa-rupee-sign text-yellow-500 text-sm"></i>
              </div>
              <div class="flex-1">
                <p class="text-sm font-medium text-gray-800">Fee payment received</p>
                <p class="text-xs text-gray-500">₹15,000 from Jane Smith</p>
              </div>
              <span class="text-xs text-gray-400">6 hours ago</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Right Column - Notifications & Alerts -->
    <div class="space-y-6">
      <!-- Admin System Panel (for Super/System Admins) -->
      <% if (userRole === 'SUPER_ADMIN' || userRole === 'SYSTEM_ADMIN' || userRole === 'SYS_ADMIN')
      { %>
      <div
        class="bg-gradient-to-r from-red-50 to-orange-50 rounded-lg shadow-sm border border-red-200"
      >
        <div class="px-6 py-4 border-b border-red-200">
          <h3 class="font-semibold flex items-center gap-2 text-red-800">
            <i class="fas fa-shield-alt text-red-500"></i>
            System Administration
          </h3>
        </div>
        <div class="p-6">
          <div class="space-y-3">
            <div class="flex items-center justify-between p-3 bg-white rounded-lg border">
              <div class="flex items-center gap-3">
                <i class="fas fa-users text-blue-500"></i>
                <span class="text-sm text-gray-700">Active Users</span>
              </div>
              <span class="text-sm font-bold text-blue-600">156</span>
            </div>
            <div class="flex items-center justify-between p-3 bg-white rounded-lg border">
              <div class="flex items-center gap-3">
                <i class="fas fa-building text-green-500"></i>
                <span class="text-sm text-gray-700">Total Schools</span>
              </div>
              <span class="text-sm font-bold text-green-600">12</span>
            </div>
            <div class="flex items-center justify-between p-3 bg-white rounded-lg border">
              <div class="flex items-center gap-3">
                <i class="fas fa-database text-purple-500"></i>
                <span class="text-sm text-gray-700">System Load</span>
              </div>
              <span class="text-sm font-bold text-purple-600">23%</span>
            </div>
            <button
              class="w-full mt-4 px-4 py-2 bg-red-600 text-white rounded-lg text-sm hover:bg-red-700 transition-colors"
            >
              <i class="fas fa-tools mr-2"></i>
              Advanced Admin Panel
            </button>
          </div>
        </div>
      </div>
      <% } %>

      <!-- Notifications -->
      <div class="bg-white rounded-lg shadow-sm border">
        <div class="px-6 py-4 border-b border-gray-200">
          <h3 class="font-semibold flex items-center gap-2 text-gray-800">
            <i class="fas fa-bell text-blue-500"></i>
            Notifications
          </h3>
        </div>
        <div class="p-6">
          <div class="space-y-3">
            <div class="p-3 bg-blue-50 border border-blue-200 rounded-lg">
              <p class="text-sm font-medium text-blue-800">System Update</p>
              <p class="text-xs text-blue-600 mt-1">New features available in the system</p>
            </div>
            <div class="p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
              <p class="text-sm font-medium text-yellow-800">Pending Approvals</p>
              <p class="text-xs text-yellow-600 mt-1">3 leave requests waiting for approval</p>
            </div>
            <div class="p-3 bg-green-50 border border-green-200 rounded-lg">
              <p class="text-sm font-medium text-green-800">Backup Complete</p>
              <p class="text-xs text-green-600 mt-1">Daily backup completed successfully</p>
            </div>
          </div>
        </div>
      </div>

      <!-- System Status -->
      <div class="bg-white rounded-lg shadow-sm border">
        <div class="px-6 py-4 border-b border-gray-200">
          <h3 class="font-semibold flex items-center gap-2 text-gray-800">
            <i class="fas fa-server text-blue-500"></i>
            System Status
          </h3>
        </div>
        <div class="p-6">
          <div class="space-y-3">
            <div class="flex items-center justify-between">
              <span class="text-sm text-gray-600">Database</span>
              <span class="text-sm font-medium text-green-600 flex items-center gap-1">
                <i class="fas fa-circle text-xs"></i>
                Online
              </span>
            </div>
            <div class="flex items-center justify-between">
              <span class="text-sm text-gray-600">Server Health</span>
              <span class="text-sm font-medium text-green-600 flex items-center gap-1">
                <i class="fas fa-circle text-xs"></i>
                Good
              </span>
            </div>
            <div class="flex items-center justify-between">
              <span class="text-sm text-gray-600">Last Backup</span>
              <span class="text-sm text-gray-500">2 hours ago</span>
            </div>
            <div class="flex items-center justify-between">
              <span class="text-sm text-gray-600">Active Users</span>
              <span class="text-sm text-gray-500">24</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  // Simple dashboard functionality
  document.addEventListener('DOMContentLoaded', function () {
    console.log('Dashboard loaded successfully');

    // Add any simple interactive features here
    const refreshBtn = document.querySelector('button[onclick="location.reload()"]');
    if (refreshBtn) {
      refreshBtn.addEventListener('click', function (e) {
        e.preventDefault();
        location.reload();
      });
    }
  });
</script>
